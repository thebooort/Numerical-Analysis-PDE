function [x] = B_n (i,t)
  if (i<=t && t<=i+1)
      x=-(2/3.)*((i+1)-t)^3+((i+2)-t)^3-(2/3.)*((i+3)-t)^3+(1/6.)*((i+4)-t)^3;
  elseif ((i+1)<t && t<=(i+2))
      x=((i+2)-t)^3-(2/3.)*((i+3)-t)^3+(1/6.)*((i+4)-t)^3;
  elseif ((i+2)<t && t<=(i+3))
      x=-(2/3.)*((i+3)-t)^3+(1/6.)*((i+4)-t)^3;
  elseif ((i+3)<t && t<=(i+4))
      x=(1/6.)*((i+4)-t)^3;
  else
      x=0;
  endif
endfunction